---
title: "Combine Rosters and Stats"
output: html_document
---

```{r}
library(tidyr)
```

```{r}
stats <- read.csv("../data/summary_statistics.csv")
roster <- read.csv("../data/full_roster.csv")
```

```{r}
roster$birth_year <-sapply(strsplit(roster$birth_date,"-"),'[',1)
roster$birth_year <- as.numeric(roster$birth_year)
roster$age <- (roster$season-roster$birth_year)
```

```{r}
smaller_roster <- roster[c('position','season','team','full_name','gsis_id','age','height','weight')]
```

```{r}
smaller_roster <- dplyr::rename(smaller_roster,PlayerID=gsis_id )
```

```{r}
filled_stats <- merge(smaller_roster,stats, by=c("PlayerID","season"))
filled_stats <- filled_stats[,!(names(filled_stats) %in% c("X"))]
```

```{r}
write.csv(filled_stats, "../data/filled_summary_statistics.csv")
```